/* ----- Base JS ----- 

TBD: THIS FILE NEEDS TO BE ORGANISED PROPERLY

*/
function cycleImages(e){var t=e.children(".active"),n=t.next().length>0?t.next():e.children("img:first");n.css("z-index",2),t.fadeOut(2e3,function(){t.css("z-index",1).show().removeClass("active"),n.css("z-index",3).addClass("active")})}function startCycleImages(){$(".inner-carousel").each(function(e){if($(this).children().length>1){var t=$(this);setInterval(function(){cycleImages(t)},6e3)}})}function workFade(){$("html").hasClass("no-touch")&&$(".work .wrapper article").each(function(){var e=$(this),t=e.offset().top-$(window).scrollTop();t<=279?e.css("opacity","1"):t>=280&&t<=300?e.css("opacity","0.9"):t>=301&&t<=330?e.css("opacity","0.8"):t>=331&&t<=360?e.css("opacity","0.7"):t>=361&&t<=390?e.css("opacity","0.6"):t>=391&&t<=420?e.css("opacity","0.5"):t>=421&&t<=450?e.css("opacity","0.4"):t>=451&&t<=480?e.css("opacity","0.3"):t>=481&&t<=510?e.css("opacity","0.2"):t>=511&&e.css("opacity","0.1")})}$(document).ready(function(){function e(){var e=$(".case-study");$(".services li a").each(function(){var t=$(this).attr("href");$(this).click(function(){return e.animate({scrollTop:$(t).offset().top},750),!1})})}$(function(){BeefSite.init()}),workFade(),e();var t=$("body").attr("id");$("#"+t+" section."+t+" .content").animate({opacity:1},500),$("#about-link").click(function(){return $("html, body").animate({scrollTop:$("#based-block").offset().top},1e3),!1});var n=[];$("#panel-work article .button").each(function(e,t){n.push(t.href)}),$("body").on("panelLoaded",function(e){n=[],$("#panel-work article .button").each(function(e,t){n.push(t.href)})}),$("body").on("overlayLoaded",function(t){startCycleImages(),e(),$(t.overlay).scrollTop(0);var r=$.inArray(window.location.href,n),i=t.overlay.find(".case-study-menu .close"),s=t.overlay.find(".case-study-menu .next-case-study"),o=t.overlay.find(".case-study-menu .prev-case-study");i.attr("href",$("body").attr("panel-url")),s.attr("href",n[r+1]),o.attr("href",n[r-1]),r===n.length-1&&s.attr("href",n[0]),r===0&&o.attr("href",n[n.length-1]),$(document).keydown(function(e){if($(".case-study.overlay").is(":visible")){if(e.keyCode==37)return o.click(),!1;if(e.keyCode==39)return s.click(),!1;if(e.keyCode==27)return i.click(),!1}})})}),$(window).on("load",function(){function e(){$(".slider ul").carouFredSel({align:"left",auto:!0,responsive:!0,height:"auto",items:{width:"variable"},scroll:{items:1,easing:"linear"},prev:{button:function(){return $(this).parents("div.slider").siblings("div.controls").find(".prev")}},next:{button:function(){return $(this).parents("div.slider").siblings("div.controls").find(".next")}},swipe:!0,onCreate:function(e){var n=this,r=setInterval(function(){t(n,r)},1e3)}})}function t(e,t){e.style.height==="0px"?$(e).trigger("updateSizes"):clearInterval(t)}$(function(){BeefSite.transitionDelay()}),$(".slider ul").length>0&&e(),$("body").on("overlayLoaded",function(){$(".slider ul").length>0&&e()}),startCycleImages()}),$(window).on("resize",function(){$(function(){BeefSite.transitionDelay()})}),$(window).on("scroll",function(){$(function(){BeefSite.scrollTransitions()}),workFade()}),$("body").on("panelLoaded",function(e){e.panel==="work"&&workFade(),e.panel==="noise"&&BeefSite.loadTweets()});var BeefSite=function(){var e=function(){s(),i()},t=function(){if($("ul.tweets").length>0&&!$("ul.tweets").hasClass("loaded")){var e=new beefTweets;e.load()}},n=function(){},r=function(){$("ul.sectors li, .sector-block h3, .home .wrapper section.based-block div, .home .wrapper section.methods-block div").each(function(){o(this)})},i=function(){$(document).keydown(function(e){if($("body#home").length||$("body#work").length||$("body#noise").length)if(!$("body").hasClass("overlay-active")){if(e.keyCode==49)return $("#panel-home").trigger("click"),!1;if(e.keyCode==50)return $("#panel-work").trigger("click"),!1;if(e.keyCode==51)return $("#panel-noise").trigger("click"),!1}})},s=function(){$(".hamburger-menu").click(function(){$("nav.site-menu").is(":hidden")?$("nav.site-menu").slideDown():$("nav.site-menu").slideUp()})},o=function(e){var t=$(e);t.isOnScreen()&&(t.hasClass("active")||t.addClass("active"))};return{init:e,scrollTransitions:r,transitionDelay:n,loadTweets:t}}();$.fn.isOnScreen=function(){var e=$(window),t={top:e.scrollTop(),left:e.scrollLeft()};t.right=t.left+e.width(),t.bottom=t.top+e.height()-300;var n=this.offset();return n.right=n.left+this.outerWidth(),n.bottom=n.top+this.outerHeight()-300,!(t.right<n.left||t.left>n.right||t.bottom<n.top||t.top>n.bottom)};